<html>
<head>
  <meta charset="utf-8">
  <title>狂神系统-代付在线文档</title>
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <link rel="stylesheet" href="__STATIC__/layui/css/layui.css">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/monokai-sublime.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js"></script>


</head>
<body layadmin-themealias="default">
<div class="layui-fluid">
  <div class="layui-card">
    <div class="layui-card-body">
      <div class="layui-tab layui-tab-brief" lay-filter="docDemoTabBrief" overflow="">
        <ul class="layui-tab-title">
          <li class="layui-this">签名规则</li>
          <li>代付api</li>
          <li>异步通知</li>
          <li>订单查询</li>
          <li>余额查询</li>
          <li>银行编码</li>
          <span class="layui-unselect layui-tab-bar" lay-stope="tabmore"><i lay-stope="tabmore" class="layui-icon"></i></span>
        </ul>
        <div class="layui-tab-content">
          <div class="layui-tab-item layui-show">
            <blockquote class="layui-elem-quote" style="word-break: break-all;">
              备注：<br>
              <blockquote class="layui-elem-quote layui-quote-nm">
                <b style="color: red;">除sign其余参数都要参与签名</b> 
              </blockquote>
              第一步：.根据代付api选项里面的参数，首字母大小写进行排序<br>
              <blockquote class="layui-elem-quote layui-quote-nm">
                amount=100&bank_code=ICBC&bank_number=123123213& bank_owner=234324&body=21&mchid=100001&amp;notify_url= 123123&out_trade_no=2005071832124472&subject=c
              </blockquote>
              第二步：排序结束后，增加&商户秘钥<br>
              <blockquote class="layui-elem-quote layui-quote-nm">
                amount=100&bank_code=ICBC&bank_number=123123213& bank_owner=234324&body=21&mchid=100001&amp;notify_url= 123123&out_trade_no=2005071832124472&subject=c&商户密钥
              </blockquote>
              第三步：md5加密<br>
              <blockquote class="layui-elem-quote layui-quote-nm">
                进行md5,签名字符串全部转为小写
              </blockquote>
              PHP加密示例代码<br>
              <blockquote class="layui-elem-quote layui-quote-nm">
                <style>
                  /* 格式化代码 */
                  pre code {
                    display: block;
                    padding-left: 2em;
                    text-indent: -2em;
                    text-align: left;
                  }
              
                  /* 添加复制按钮 */
                  .copy-btn {
                    background-color: #4CAF50;
                    border: none;
                    color: white;
                    padding: 8px 16px;
                    text-align: center;
                    text-decoration: none;
                    display: inline-block;
                    font-size: 14px;
                    margin: 4px 2px;
                    cursor: pointer;
                    border-radius: 4px;
                  }
                </style>
                <pre>
                  <code class="php">
                    &lt;?php
                    function generateSign($data, $key) {
                      // 按字母顺序排序参数
                      ksort($data);
                    
                      // 拼接参数和商户秘钥
                      $signData = '';
                      foreach ($data as $k => $value) {
                        $signData .= $k . '=' . $value . '&';
                      }
                      $signData .= $key;
                    
                      // 使用MD5进行加密
                      return strtolower(md5($signData));
                    }
            
                    $data = [
                    'amount' => '100',
                    'bank_code' => 'ICBC',
                    'bank_number' => '123123213',
                    'bank_owner' => '234324',
                    'body' => '21',
                    'mchid' => '100001',
                    'notify_url' => 'http://127.0.0.1/notify.php',
                    'out_trade_no' => '2005071832124472',
                    'subject' => 'c',
                  ];
                  $key = '商户密钥';
                  
                  $sign = generateSign($data, $key);
             
                  ?&gt;
                  </code>
                </pre>
                <script src="https://cdn.jsdelivr.net/npm/highlight.js@10.7.2/lib/highlight.min.js"></script>
                <script>
                  hljs.initHighlightingOnLoad();
                </script>
                
              </blockquote>
          
            </blockquote>
          </div>
          <div class="layui-tab-item">
            <blockquote class="layui-elem-quote">
              网关地址：http://www.demo.com/api/dfpay/pay
              <br><br>
              注意要点：POST <strong style="color: red;font-size: 1.3rem">form-data</strong> 方式请求
            </blockquote>
            <div class="layui-tab">
              <ul class="layui-tab-title">
                <li class="layui-this">参数说明</li>
                <li>返回示例</li>
              </ul>
              <div class="layui-tab-content">
                <div class="layui-tab-item layui-show">
                  <table class="layui-table">
                    <tbody>
                    <tr>
                      <td style="font-weight:bold">参数名</td>
                      <td style="font-weight:bold">必选</td>
                      <td style="font-weight:bold">类型</td>
                      <td style="font-weight:bold">说明</td>
                      <td style="font-weight:bold">参与签名</td>
                    </tr>
                    <tr>
                      <td>mchid</td>
                      <td>是</td>
                      <td>string</td>
                      <td>商户id</td>
                      <td>是</td>
                    </tr>
                    <tr>
                      <td>out_trade_no</td>
                      <td>是</td>
                      <td>string</td>
                      <td>商户订单 id 唯一 不能重复 重复会创建订单失败 由商户控制</td>
                      <td>是</td>
                    </tr>
                    <tr>
                      <td>amount</td>
                      <td>是</td>
                      <td>double</td>
                      <td>金额 最大两位小数</td>
                      <td>是</td>
                    </tr>
                    <tr>
                      <td>bank_code</td>
                      <td>是</td>
                      <td>string</td>
                      <td>提交银行编码（也可以直接提交银行名称如：中国银行）</td>
                      <td>是</td>
                    </tr>
                    <tr>
                      <td>notify_url</td>
                      <td>是</td>
                      <td>string</td>
                      <td>异步通知地址 必须http:或者https:格式</td>
                      <td>是</td>
                    </tr>
                    <tr>
                      <td>bank_number</td>
                      <td>是</td>
                      <td>string</td>
                      <td>银行账号</td>
                      <td>是</td>
                    </tr>
                    <tr>
                      <td>bank_owner</td>
                      <td>是</td>
                      <td>string</td>
                      <td>开户姓名</td>
                      <td>是</td>
                    </tr>
                    <tr>
                      <td>body</td>
                      <td>是</td>
                      <td>string</td>
                      <td>请填１２３</td>
                      <td>是</td>
                    </tr>
                    <tr>
                      <td>sign</td>
                      <td>是</td>
                      <td>string</td>
                      <td>签名 见签名规则</td>
                      <td>否</td>
                    </tr>
                    </tbody>
                  </table>
                </div>
                <div class="layui-tab-item">
                  <pre class="layui-code">
{
    "code": 1,  //1 表示成功 其它表示 失败
    "msg": "请求成功",     //信息
    "data": {     //订单信息
        "amount": "100",  //代付金额
        "trade_no":"C20200507174156507348",  //平台订单号
        "out_trade_no": "2005071741563614"  //商户订单 id
    }
}
                  </pre>
                </div>
              </div>
            </div>
          </div>
          <div class="layui-tab-item">
            <blockquote class="layui-elem-quote">
              该通知以POST <strong style="color: red;font-size: 1.3rem">form-data</strong> 方式请求，编码：UTF8<br></br>
              SUCCESS 返回成功表示通知成功</br>
            </blockquote>

            <fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
              <legend>参数说明</legend>
            </fieldset>
            <div class="layui-tab">
              <ul class="layui-tab-title">
                <li class="layui-this">参数说明</li>
              </ul>
              <div class="layui-tab-content">
                <div class="layui-tab-item layui-show">
                  <table class="layui-table">
                    <tbody>
                    <tr>
                      <td style="font-weight:bold">参数名</td>
                      <td style="font-weight:bold">必选</td>
                      <td style="font-weight:bold">类型</td>
                      <td style="font-weight:bold">说明</td>
                      <td style="font-weight:bold">参与签名</td>

                    </tr>
                    <tr>
                      <td>amount</td>
                      <td>string</td>
                      <td>是</td>
                      <td>金额</td>
                      <td>是</td>
                    </tr>
                    <tr>
                      <td>trade_no</td>
                      <td>string</td>
                      <td>是</td>
                      <td>平台订单号</td>
                      <td>是</td>
                    </tr>
                    <tr>
                      <td>sign</td>
                      <td>string</td>
                      <td>是</td>
                      <td>签名 见签名规则</td>
                      <td>否</td>
                    </tr>
                    <tr>
                      <td>code</td>
                      <td>string</td>
                      <td>是</td>
                      <td>请求状态：1 成功，0 失败</td>
                      <td>是</td>
                    </tr>
                    <tr>
                      <td>error_reason</td>
                      <td>string</td>
                      <td>是</td>
                      <td>代付备注：代付成功时为空，代付失败时为失败原因</td>
                      <td>是</td>
                    </tr>
                    <tr>
                      <td>status</td>
                      <td>string</td>
                      <td>是</td>
                      <td>订单状态 status:2表示代付成功 status:0表示代付失败 其他值如1，3表示订单处理中</td>
                      <td>是</td>
                    </tr>
                    <tr>
                      <td>msg</td>
                      <td>string</td>
                      <td>是</td>
                      <td>固定值 ok</td>
                      <td>是</td>
                    </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
          <div class="layui-tab-item">
            <blockquote class="layui-elem-quote">
              网关地址：http://www.demo.com/api/dfpay/query
              <br><br>
              注意要点：POST <strong style="color: red;font-size: 1.3rem">form-data</strong> 方式请求，编码：UTF8
            </blockquote>
            <div class="layui-tab">
              <ul class="layui-tab-title">
                <li class="layui-this">参数说明</li>
                <li>返回内容示例</li>
              </ul>
              <div class="layui-tab-content">
                <div class="layui-tab-item layui-show">
                  <table class="layui-table">
                    <tbody>
                    <tr>
                      <td style="font-weight:bold">参数名</td>
                      <td style="font-weight:bold">必选</td>
                      <td style="font-weight:bold">类型</td>
                      <td style="font-weight:bold">说明</td>
                      <td style="font-weight:bold">参与签名</td>
                    </tr>
                    <tr>
                      <td>out_trade_no</td>
                      <td>是</td>
                      <td>string</td>
                      <td>商户订单号</td>
                      <td>是</td>
                    </tr>
                    <tr>
                      <td>mchid</td>
                      <td>是</td>
                      <td>string</td>
                      <td>商户号</td>
                      <td>是</td>
                    </tr>
                    <tr>
                      <td>sign</td>
                      <td>是</td>
                      <td>string</td>
                      <td>签名 见签名规则</td>
                      <td>否</td>
                    </tr>
                    </tbody>
                  </table>
                </div>
                <div class="layui-tab-item">
                    <pre class="layui-code">
{
  "code": 1,   //1 表示查询成功
  "msg": "请求成功",  //返回操作消息
  "data": {   //查询数据
    "status": 1,    //订单状态 2 表示订单成功 0 表示 订单 失败 1 和 3 表示正在被处理 中
    "out_trade_no": "1905171403045247",   //商户订单号
    "trade_no": "B20190517140304517826",   //平台订单号
    "create_time": "2019-05-17 14:03:04",   //订单创建时间
    "amount": "1000.00",   //金额
    "sign": "db3738b1625324975a342774aa3ecaa2"   //签名
  }
}

                    </pre>
                </div>
              </div>
            </div>
          </div>
          <div class="layui-tab-item">
            <blockquote class="layui-elem-quote">
              网关地址：http://www.xxxx.com/api/pay/balance
              <br><br>
              注意要点：POST <strong style="color: red;font-size: 1.3rem">form-data</strong> 方式请求，编码：UTF8
            </blockquote>
            <div class="layui-tab">
              <ul class="layui-tab-title">
                <li class="layui-this">参数说明</li>
                <li>返回内容示例</li>
              </ul>
              <div class="layui-tab-content">
                <div class="layui-tab-item layui-show">
                  <table class="layui-table">
                    <colgroup>
                      <col width="160">
                      <col width="100">
                      <col width="120">
                      <col width="120">
                    </colgroup>
                    <tbody>
                    <tr>
                      <td style="font-weight:bold">参数</td>
                      <td style="font-weight:bold">类型</td>
                      <td style="font-weight:bold">是否必填</td>
                      <td style="font-weight:bold">描述</td>
                    </tr>
                    <tr>
                      <td>mchid</td>
                      <td>string</td>
                      <td>是</td>
                      <td>商户id</td>
                    </tr>
                    <tr>
                      <td>sign</td>
                      <td>string</td>
                      <td>是</td>
                      <td>签名 见签名规则</td>
                    </tr>
                    </tbody>
                  </table>
                </div>
                <div class="layui-tab-item">
                    <pre class="layui-code">
{
    "code": 0,
    "msg": "请求成功",
    "data": {
          "balance":"100.000"
    }
}
                    </pre>
                </div>
              </div>
            </div>
          </div>
          <div class="layui-tab-item">
            <div class="layui-tab">
              <div class="layui-tab-content">
                <div class="layui-tab-item layui-show">
                  <table class="layui-table">
                    <colgroup>
                      <col width="160">
                      <col width="100">
                      <col width="120">
                      <col width="120">
                    </colgroup>
                    <tbody>
                    <tr>
                      <td style="font-weight:bold">银行名称</td>
                      <td style="font-weight:bold">编码</td>
                    </tr>
                    <tr>
                      <td>桂林银行</td>
                      <td>GLB</td>
                    </tr>
                    <tr>
                      <td>支付宝</td>
                      <td>ZFB</td>
                    </tr>
                    <tr>
                      <td>工商银行</td>
                      <td>ICBC</td>
                    </tr>
                    <tr>
                      <td>农业银行</td>
                      <td>ABC</td>
                    </tr>
                    <tr>
                      <td>中国民生银行</td>
                      <td>CMBC</td>
                    </tr>
                    <tr>
                      <td>中国建设银行</td>
                      <td>CCB</td>
                    </tr>
                    <tr>
                      <td>兴业银行</td>
                      <td>CIB</td>
                    </tr>
                    <tr>
                      <td>招商银行</td>
                      <td>CMB</td>
                    </tr>
                    <tr>
                      <td>中国光大银行</td>
                      <td>CEB</td>
                    </tr>
                    <tr>
                      <td>中国邮政储蓄银行</td>
                      <td>PSBC</td>
                    </tr>
                    <tr>
                      <td>中国银行</td>
                      <td>BOC</td>
                    </tr>
                    <tr>
                      <td>平安银行</td>
                      <td>PAB</td>
                    </tr>
                    <tr>
                      <td>中国农业银行</td>
                      <td>ABC</td>
                    </tr>
                    <tr>
                      <td>北京银行</td>
                      <td>BOB</td>
                    </tr>
                    <tr>
                      <td>上海浦东发展银行</td>
                      <td>SPDB</td>
                    </tr>
                    <tr>
                      <td>宁波银行</td>
                      <td>NBCB</td>
                    </tr>
                    <tr>
                      <td>中信银行</td>
                      <td>CITIC</td>
                    </tr>
                    <tr>
                      <td>华夏银行</td>
                      <td>HXB</td>
                    </tr>
                    <tr>
                      <td>交通银行</td>
                      <td>COMM</td>
                    </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


<script src="__STATIC__/layui/layui.js"></script>

<script>
  layui.use('element', function () {
  });
</script>

</body>
</html>